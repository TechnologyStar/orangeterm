# OrangeTerm 最新功能说明

## 概述
本文档详细介绍了 OrangeTerm 最新添加的主要功能，包括 OpenAI 兼容 API 配置、知识库管理、自定义 MCP 服务器、初始化向导和高级玻璃主题。

## 新增功能

### 1. OpenAI 兼容 API 配置

**位置**：设置选项卡 → API 配置

用户现在可以配置 OpenAI 兼容的 API 端点：

- **服务商**：OpenAI、Azure OpenAI 或自定义端点
- **API 密钥**：安全存储 API 凭证
- **接口地址**：自定义 API 端点 URL（可选）
- **模型**：指定自定义模型名称（可选）

**使用场景**：
- 使用 OpenAI 官方 API
- 连接 Azure OpenAI 服务
- 使用第三方 OpenAI 兼容服务（例如 LocalAI、带 OpenAI 兼容层的 Ollama）
- 自托管 AI 模型与 OpenAI 兼容 API

**使用方法**：
1. 导航到设置选项卡
2. 选择 API 配置部分
3. 选择您的服务商
4. 输入您的 API 密钥
5. 可选配置接口地址和模型
6. 点击保存

### 2. 知识库管理

**位置**：设置选项卡 → 知识库

用户现在可以添加、编辑和删除自定义命令知识条目：

**功能**：
- 添加带描述的自定义命令
- 指定命令使用模式
- 提供多个示例
- 设置风险等级（低、中、高）
- 编辑现有条目
- 删除条目

**使用方法**：
1. 导航到设置 → 知识库
2. 点击"添加知识条目"
3. 填写命令详情：
   - 命令名称（例如 `docker`）
   - 描述
   - 用法语法
   - 示例（每行一个）
   - 风险等级
4. 保存条目

**优势**：
- 用自定义命令扩展 AI 的知识
- 记录内部脚本和工具
- 标准化团队命令使用
- 提高 AI 建议准确性

### 3. 自定义 MCP 服务器支持

**位置**：设置选项卡 → MCP 服务器

用户可以添加和管理自定义模型上下文协议（MCP）服务器：

**功能**：
- 添加带命令和参数的自定义 MCP 服务器
- 配置环境变量
- 动态启用/禁用服务器
- 删除服务器

**使用方法**：
1. 导航到设置 → MCP 服务器
2. 点击"添加 MCP 服务器"
3. 配置：
   - 服务器名称
   - 命令（例如 `npx`、`node`、`python`）
   - 参数（例如 `-y @modelcontextprotocol/server-filesystem /tmp`）
   - 环境变量（JSON 格式）
4. 点击保存

**MCP 服务器示例**：
```json
{
  "name": "文件系统服务器",
  "command": "npx",
  "args": "-y @modelcontextprotocol/server-filesystem /home/user",
  "env": {}
}
```

```json
{
  "name": "数据库服务器",
  "command": "node",
  "args": "/path/to/mcp-server.js",
  "env": {
    "DB_HOST": "localhost",
    "DB_PORT": "5432"
  }
}
```

### 4. 初始化向导

**触发时机**：首次启动（应用未初始化时）

多步骤向导引导新用户完成初始设置：

**步骤**：
1. **欢迎**：OrangeTerm 介绍
2. **API 配置**：设置 AI API（可跳过）
3. **服务器配置**：添加第一台服务器（可跳过）
4. **完成**：完成设置

**功能**：
- 如果未准备好可跳过任何步骤
- 美观的玻璃态 UI
- 进度跟踪
- 可通过清除设置重新触发

### 5. 高级玻璃主题

**位置**：设置选项卡 → 主题

受 macOS 和 Apple 设计语言启发的现代、美观的玻璃态主题：

**功能**：
- **玻璃态效果**：带背景模糊的磨砂玻璃
- **美丽的渐变**：紫色到粉色的渐变背景
- **流畅动画**：丝滑般的过渡效果
- **现代色彩方案**：靛蓝主色调（#6366f1）
- **高级阴影**：微妙的深度和层次
- **圆角**：现代的 12px 边框半径
- **半透明卡片**：分层玻璃面板

**如何切换主题**：
1. 导航到设置 → 主题
2. 在以下选项中选择：
   - **深色主题**：原始橙色主题配深色背景
   - **玻璃主题**：新的高级玻璃态主题
3. 重启应用以获得完整效果

**视觉元素**：
- 头部：带渐变阴影的磨砂玻璃
- 卡片：带背景模糊的半透明
- 按钮：带悬停状态的玻璃效果
- 背景：渐变网格（紫色到粉色）
- 图标：流畅的渐变填充

### 6. 设置选项卡

**新导航选项卡**：设置（与对话和服务器并列）

带选项卡界面的集中设置管理：

**部分**：
1. **API 配置**：OpenAI 兼容 API 设置
2. **主题**：在深色和玻璃主题之间切换
3. **知识库**：管理命令知识条目
4. **MCP 服务器**：配置自定义 MCP 服务器

## 技术实现

### 新增文件
- `src/lib/SettingsManager.ts` - 设置持久化
- `src/renderer/components/SettingsPanel.tsx` - 设置 UI
- `src/renderer/components/InitWizard.tsx` - 首次运行向导

### 更新文件
- `src/types/index.ts` - API 配置、设置、MCP 服务器的新类型
- `src/lib/i18n.ts` - 所有新功能的翻译
- `src/lib/KnowledgeBase.ts` - 添加/删除条目方法
- `src/main/main.ts` - 新功能的 IPC 处理器
- `src/preload/preload.ts` - API 暴露
- `src/renderer/App.tsx` - 玻璃主题和向导集成

### 新增 IPC API
- `saveSettings(settings)` - 保存应用设置
- `getSettings()` - 加载应用设置
- `addKnowledgeEntry(entry)` - 添加知识条目
- `deleteKnowledgeEntry(command)` - 删除知识条目
- `addMCPServer(server)` - 添加 MCP 服务器
- `getMCPServers()` - 列出 MCP 服务器
- `deleteMCPServer(id)` - 删除 MCP 服务器
- `toggleMCPServer(id, enabled)` - 启用/禁用 MCP 服务器

## 用户优势

1. **灵活性**：连接任何 OpenAI 兼容的 AI 服务
2. **定制化**：用自定义命令扩展知识库
3. **可扩展性**：为专业功能添加自定义 MCP 服务器
4. **用户友好**：为新用户提供引导式设置
5. **美观 UI**：现代体验的高级玻璃主题
6. **选择权**：根据偏好在主题之间切换

## 迁移说明

- 现有用户将默认看到玻璃主题（可切换到深色主题）
- 现有安装首次启动时不显示初始化向导
- 所有现有功能保持不变
- 设置存储在内存中（可通过持久化存储增强）

## 未来增强

- 设置的持久化存储（electron-store 或类似工具）
- 跨设备的云同步设置
- 导入/导出知识库
- MCP 服务器模板和市场
- 主题定制（自定义颜色、渐变）
- 深色玻璃主题变体

## 屏幕截图

### 玻璃主题
- 带磨砂玻璃面板的渐变背景
- 现代靛蓝/紫色配色方案
- 流畅的阴影和模糊效果

### 初始化向导
- 逐步引导式设置
- 所有步骤的跳过功能
- 美观的模态设计

### 设置面板
- 不同设置的选项卡界面
- 基于表单的配置
- 知识库和 MCP 服务器的表格视图

## 结论

这些新功能使 OrangeTerm 更加灵活、强大和美观。用户现在可以：
- 使用任何 OpenAI 兼容的 AI 服务
- 用自定义命令扩展知识库
- 为专业工具添加自定义 MCP 服务器
- 享受玻璃主题带来的高级 UI 体验
- 通过向导获得初始设置的引导

该应用现在提供了一个完整、专业的运维终端，具有可完全定制以满足特定需求的 AI 功能。

## 常见问题

### Q: 如何切换回深色主题？
A: 转到设置 → 主题，选择"深色主题"，然后重启应用。

### Q: API 密钥安全吗？
A: 是的，API 密钥存储在 Electron 应用的本地内存中，不会发送到外部服务器（除了您配置的 API 端点）。

### Q: 我可以添加多少个知识库条目？
A: 没有硬性限制，但建议保持合理数量以获得最佳性能。

### Q: MCP 服务器是什么？
A: MCP（模型上下文协议）服务器是提供额外工具和功能给 AI 模型的扩展点。您可以添加自定义服务器来扩展 AI 的能力。

### Q: 初始化向导可以重新运行吗？
A: 目前需要手动清除设置才能重新显示向导。未来版本将添加重置选项。

### Q: 玻璃主题会影响性能吗？
A: 玻璃效果（背景模糊）在现代硬件上性能影响很小。如果遇到性能问题，可以切换到深色主题。

## 支持

如有问题或功能请求，请访问项目仓库或联系开发团队。

---

**版本**：1.1.0  
**更新日期**：2024年12月  
**作者**：OrangeTerm Team
